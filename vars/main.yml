php_packages_extra:
  - php-mysql
  - php-curl
  - php-common
  - php-imagick
  - php-mbstring
  - php-xml
  - php-zip
  - php-json
  - php-xmlrpc
  - php-gd
  - unzip


php_webserver_daemon: "nginx"

php_enable_php_fpm: true

php_fpm_pools:
  - pool_name: mysite
    pool_template: www.conf.j2
    pool_listen: /run/php/mysite.sock;
    pool_listen_allowed_clients: any
    pool_pm: dynamic
    pool_pm_max_children: 5
    pool_pm_start_servers: 2
    pool_pm_min_spare_servers: 1
    pool_pm_max_spare_servers: 3
    pool_pm_max_requests: 500
    pool_pm_status_path: /status

nginx_vhosts:
  - listen: "80"
    server_name: "mysite.com"
    server_name_redirect: "www.example.com"
    root: "/var/www/html"
    index: "index.php index.html index.htm"
    state: "present"
    template: "{{ nginx_vhost_template }}"
    filename: "mysite.conf"
    extra_parameters: |
        location ~ \.php$ {
        include snippets/fastcgi-php.conf;
    
          # Nginx php-fpm sock config:
          fastcgi_pass unix:/run/php/php8.1-fpm.sock;
          # Nginx php-cgi config :
          # Nginx PHP fastcgi_pass 127.0.0.1:9000;
        }
      
        # deny access to Apache .htaccess on Nginx with PHP, 
        # if Apache and Nginx document roots concur
        location ~ /\.ht {
          deny all;
        }
  
  - listen: "80"
    server_name: "denmark.com"
    server_name_redirect: "www.denmark.com"
    root: "/home/denmark/public_html"
    index: "index.php index.html index.htm"
    state: "present"
    template: "{{ nginx_vhost_template }}"
    filename: "denmark.conf"
    extra_parameters: |
        location ~ \.php$ {
        include snippets/fastcgi-php.conf;
    
          # Nginx php-fpm sock config:
          fastcgi_pass unix:/run/php/php8.1-fpm.sock;
          # Nginx php-cgi config :
          # Nginx PHP fastcgi_pass 127.0.0.1:9000;
        }
      
        # deny access to Apache .htaccess on Nginx with PHP, 
        # if Apache and Nginx document roots concur
        location ~ /\.ht {
          deny all;
        }

mysql_databases:
  - name: mysite_db
    encoding: latin1
    collation: latin1_general_ci
  
  - name: denmark_db

mysql_users:
  - name: mysite
    host: "%"
    password: password
    priv: "mysite_db.*:ALL"
  
  - name: denmark
    host: "%"
    password: password
    priv: "denmark_db.*:ALL"

wordpress_site:
  - wordpress_user: denmark
  - wordpress_user: kathleene
